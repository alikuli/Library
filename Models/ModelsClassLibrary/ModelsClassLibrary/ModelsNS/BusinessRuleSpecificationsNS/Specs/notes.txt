This was taken from my book called Professional ASP.Patterns By Scott Millett, pages 121 onwards